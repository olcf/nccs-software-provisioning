-- ############################################################
-- This file is maintained by ansible
-- Last modified: {{ ansible_date_time.date }}
-- ############################################################

family("compiler")

help([[
AOCC Compiler
]])


local base = "{{ NSP_install_root }}"
local package = "aocc"
local version = "{{ NSP_AOCC_version_major }}.{{ NSP_AOCC_version_middle }}.{{ NSP_AOCC_version_minor }}"
local prefix = pathJoin(base, package, version)

whatis("Description: AOCC compiler " .. version)

-- Setup Modulepath for spack packages built by this compiler
{% for path in extra_module_paths %}
prepend_path("MODULEPATH", "{{ path }}")
{% endfor %}

-- Environment Globals
prepend_path( "PATH",  pathJoin(prefix, "bin" ) )
prepend_path( "PATH",  pathJoin(prefix, "share/opt-viewer" ) )
prepend_path( "MANPATH", pathJoin(prefix, "share/man" ) )
prepend_path( "LD_LIBRARY_PATH", pathJoin(prefix, "ompd") )
prepend_path( "LD_LIBRARY_PATH", pathJoin(prefix, "lib") )
prepend_path( "LD_LIBRARY_PATH", pathJoin(prefix, "lib32") )
prepend_path( "C_INCLUDE_PATH", pathJoin(prefix, "include") )
prepend_path( "CPLUS_INCLUDE_PATH", pathJoin(prefix, "include") )

-- OLCF specific Environment
setenv("OLCF_" .. package:upper() .. "_ROOT",  prefix)
