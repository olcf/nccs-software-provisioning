---
- name: "Check for Previous AOCC v{{ NSP_AOCC_version_major }}.{{ NSP_AOCC_version_middle }}.{{ NSP_AOCC_version_minor }} Installation"
  ansible.builtin.stat:
    path: "{{ NSP_install_root }}/aocc/{{ NSP_AOCC_version_major }}.{{ NSP_AOCC_version_middle }}.{{ NSP_AOCC_version_minor }}"
  register: install_status

- name: "Launch AOCC v{{ NSP_AOCC_version_major }}.{{ NSP_AOCC_version_middle }}.{{ NSP_AOCC_version_minor }} Install"
  ansible.builtin.include_tasks: install.yaml
  when: install_status.stat.exists == False

- name: "Ensure AOCC v{{ NSP_AOCC_version_major }}.{{ NSP_AOCC_version_middle }}.{{ NSP_AOCC_version_minor }} Module Folder Exists"
  ansible.builtin.file:
    path: "{{ NSP_install_root }}/modulefiles/aocc"
    state: directory

- name: "Ensure AOCC v{{ NSP_AOCC_version_major }}.{{ NSP_AOCC_version_middle }}.{{ NSP_AOCC_version_minor }} Module File Exists"
  ansible.builtin.template:
    src: module.lua.j2
    dest: "{{ NSP_install_root }}/modulefiles/aocc/{{ NSP_AOCC_version_major }}.{{ NSP_AOCC_version_middle }}.{{ NSP_AOCC_version_minor }}.lua"
