---
- name: "Check for Previous AOCC v{{ NSP_AOCC_version }} Installation"
  ansible.builtin.stat:
    path: "{{ [NSP_install_root, 'aocc', NSP_AOCC_version] | path_join }}"
  register: install_status

- name: "Launch AOCC v{{ NSP_AOCC_version }} Install"
  ansible.builtin.include_tasks: install.yaml
  when: install_status.stat.exists == False

- name: "Ensure AOCC v{{ NSP_AOCC_version }} Module Folder Exists"
  ansible.builtin.file:
    path: "{{ [NSP_module_root, 'aocc'] | path_join }}"
    state: directory

- name: "Ensure AOCC v{{ NSP_AOCC_version }} Module File Exists"
  ansible.builtin.template:
    src: module.lua.j2
    dest: "{{ [NSP_module_root, 'aocc', NSP_AOCC_version ~ '.lua'] | path_join }}"
